extends "GradleJob.pkl"

import "@gha/catalog.pkl"
import "@gha/Workflow.pkl"
import "@pkl.impl.ghactions/helpers.pkl"

local self = this

command: String

arch = "amd64"

os = "linux"

steps {
  catalog.`actions/checkout@v6`
  (catalog.`actions/download-artifact@v5`) {
    with {
      pattern = "executable-**"
      `merge-multiple` = true
    }
  }
  new Workflow.Step {
    run = "./gradlew \(self.gradleArgs) \(module.command)"
  }
    |> helpers.withMavenPublishSecrets
}

fixed job {
  environment = "maven-release"
}
